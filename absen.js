 // Data siswa untuk setiap kelas (40 siswa per kelas)
        const studentsByClass = {
            "X1": [
                { id: 1, name: "Ahmad Rhohim", class: "X1" },
                { id: 2, name: "Akbar zada", class: "X1" },
                { id: 3, name: "Ardan Hafidzh Isnaen", class: "X1" },
                { id: 4, name: "Arkaan Arif Keivaro", class: "X1" },
                { id: 5, name: "Asyafiqu Muntaz Purnomo", class: "X1" },
                { id: 6, name: "Fadhil Hibrizi Arsy", class: "X1" },
                { id: 7, name: "Faishal Akbari Muhtarom", class: "X1" },
                { id: 8, name: "Fityan zidna Hudan", class: "X1" },
                { id: 9, name: "Gianelza Arusetyo Masyifa", class: "X1" },
                { id: 10, name: "Hanif Rizki Nur Hakim", class: "X1" },
                { id: 11, name: "Ihsan Ali Hakim", class: "X1" },
                { id: 12, name: "Kafka Nasril  Abigail Rosyid", class: "X1" },
                { id: 13, name: "Kevin Ardiansyah", class: "X1" },
                { id: 14, name: "Khoirul Mizan", class: "X1" },
                { id: 15, name: "M Dzahwan Atha Pramayuda", class: "X1" },
                { id: 16, name: "M Zakaria Azzuhri Darman", class: "X1" },
                { id: 17, name: "M Abdurrahman Al-Qomaroiny ", class: "X1" },
                { id: 18, name: "M abyan faiq Aflah hariq", class: "X1" },
                { id: 19, name: "M Faiz Ar Rouf", class: "X1" },
                { id: 20, name: "M favian walid", class: "X1" },
                { id: 21, name: "M hafidz abdillah", class: "X1" },
                { id: 22, name: "M Khalil Fauzan", class: "X1" },
                { id: 23, name: "M Qadli Dzaka Junior", class: "X1" },
                { id: 24, name: "M Rafa Khair Al Din Pramesti", class: "X1" },
                { id: 25, name: "M Salman Alfarisy", class: "X1" },
                { id: 26, name: "M Taufik Akbar", class: "X1" },
                { id: 27, name: "M Tsavik Irsyadi", class: "X1" },
                { id: 28, name: "Nasrullah", class: "X1" },
                { id: 29, name: "Rio Abdul Hakim Irzananda", class: "X1" },
                { id: 30, name: "Wan Rikhad Zami Musyafik", class: "X1" },
                { id: 31, name: "M Fadhil al haidar", class: "X1"},
                { id: 32, name: "M Aulawi Kanzul Arzy", class: "X1" },
                { id: 33, name: "Ahmad Faozie Mubarok", class: "X1" },
               
                
            ],
            "X2": [
                { id: 1, name: "Ahmad faoze Mubarok", class: "X2" },
                { id: 2, name: "alfattah Banyu Khoirezo", class: "X2" },
                { id: 3, name: "Anis hamidan", class: "X2" },
                { id: 4, name: "Atthaya Zufar Ahmad", class: "X2" },
                { id: 5, name: "Azziri Irsyad saputro", class: "X2" },
                { id: 6, name: "Dika Alvindo", class: "X2" },
                { id: 7, name: "Dimas Hendro Prasetro", class: "X2" },
                { id: 8, name: "Fa'iq Althaf Zayyan", class: "X2" },
                { id: 9, name: "Galang Wahyu Diansyah", class: "X2" },
                { id: 10, name: "M Hanif Akmal Zufillah", class: "X2" },
                { id: 11, name: "M aljabar Maulana", class: "X2" },
                { id: 12, name: "M Farid Qisthi", class: "X2" },
                { id: 13, name: "M Hifza Al Yusron", class: "X2" },
                { id: 14, name: "M afton Nafis Fatichul Machaly", class: "X2" },
                { id: 15, name: "Mohammdah Afthon Nafis Fatichul Machaly", class: "X2" },
                { id: 16, name: "Mohammad alfata Noorshahreza", class: "X2" },
                { id: 17, name: "Mohammad Hasyim Muzadi", class: "X2" },
                { id: 18, name: "Muahammad Azzam Al Fatah", class: "X2" },
                { id: 19, name: "Muhammad Hairi Yazdi", class: "X2" },
                { id: 20, name: "Muahammad nabil Al Heru", class: "X2" },
                { id: 21, name: "Muhammad Nashirudin  Fakhir", class: "X2" },
                { id: 22, name: "Muhammad Rozaqna Al Kautsar", class: "X2" },
                { id: 23, name: "Reynard Azka Waafi Prayudi", class: "X2" },
                { id: 24, name: "Riefky yoan Satria Nugraha", class: "X2" },
                { id: 25, name: "Rizki Akbar Malik", class: "X2" },
                { id: 26, name: "Rizky Hadyan abiya", class: "X2" },
                { id: 27, name: "Robby Ahdy Hikamaka", class: "X2" },
                { id: 28, name: "Muhammad Fauzan Aziz ", class: "X2" },
                { id: 29, name: "Mifthaul Fitrah", class: "X2" },
               
                
            ],
            "X3": [
                { id: 1, name: "Achmad Ibrahim Tyas", class: "X3" },
                { id: 2, name: "Afif Fadhil Mu'afi", class: "X3" },
                { id: 3, name: "Ahmad Fathoni Islahul Anam", class: "X3" },
                { id: 4, name: "Akmal Nugraha Faghrezi", class: "X3" },
                { id: 5, name: "Al irsyadu Zaidun Karim", class: "X3" },
                { id: 6, name: "Atha Atmaja Afzhal Daniswara", class: "X3" },
                { id: 7, name: "Avin Zamir Farras", class: "X3" },
                { id: 8, name: "Dheramos Rovert Haifer", class: "X3" },
                { id: 9, name: "Dzaky Ridho", class: "X3" },
                { id: 10, name: "Fadhlan Ahsanul Azmi", class: "X3" },
                { id: 11, name: "Faiz Zulfan Arraja", class: "X3" },
                { id: 12, name: "Imdad Hikmatul Arkan", class: "X3" },
                { id: 13, name: "M Atha Wafi", class: "X3" },
                { id: 14, name: "M rifki Adhitya", class: "X3" },
                { id: 15, name: "Mohammad Luthfi Chakim", class: "X3" },
                { id: 16, name: "Moh. Nizam Ni'ami", class: "X3" },
                { id: 17, name: "Mohammad Rahlil Bintang", class: "X3" },
                { id: 18, name: "Muhammad Azzam setiawan", class: "X3" },
                { id: 19, name: "Muhammad Azzril Ashidiqi", class: "X3" },
                { id: 20, name: "Muhammad DEadat Ghozali Syihab", class: "X3" },
                { id: 21, name: "Muhammad Naufal", class: "X3" },
                { id: 22, name: "Muhammad Royyan Muzzamil", class: "X3" },
                { id: 22, name: "Muhammad Zein Aly Dzihny", class: "X3" },
                { id: 21, name: "Muhammad zein Dzihny", class: "X3" },
                { id: 22, name: "Muhammad zidni Baihaqi", class: "X3" },
                { id: 23, name: "Putra Zabdannalla sidiq", class: "X3" },
                { id: 24, name: "Radesta Octora Mandalika Hasibun", class: "X3" },
                { id: 25, name: "Satria Octaviayandi Putra Pratama", class: "X3" },
                { id: 26, name: "Ula Bashorul Haqqi Masyhuda", class: "X3" },
                { id: 27, name: "Wisnu Faith Alma", class: "X3" },
                { id: 28, name: "Bendir Wiska Prasetyo", class: "X3" },
                { id: 29, name: "Faiz Nadhar", class: "X3" },
               
            ]
        };

        // Inisialisasi data absensi
        let attendanceData = JSON.parse(localStorage.getItem('attendanceData')) || {};
        let currentDate = new Date();
        let currentClass = "X1";

        // Format tanggal untuk kunci penyimpanan
        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }

        // Format tanggal untuk tampilan
        function formatDateDisplay(date) {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('id-ID', options);
        }

        // Format tanggal singkat untuk folder
        function formatDateShort(date) {
            const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
            return date.toLocaleDateString('id-ID', options);
        }

        // Inisialisasi data untuk tanggal dan kelas saat ini
        function initializeData() {
            const dateKey = formatDate(currentDate);
            const classKey = currentClass;
            
            if (!attendanceData[dateKey]) {
                attendanceData[dateKey] = {};
            }
            
            if (!attendanceData[dateKey][classKey]) {
                attendanceData[dateKey][classKey] = {};
                studentsByClass[classKey].forEach(student => {
                    attendanceData[dateKey][classKey][student.id] = 'present'; // Default: hadir
                });
            }
        }

        // Fungsi untuk memperbarui tampilan
        function updateDisplay() {
            const tableBody = document.getElementById('attendanceTable');
            const searchInput = document.getElementById('searchInput');
            const filter = document.querySelector('.filter-btn.active').dataset.filter;
            const searchTerm = searchInput.value.toLowerCase();
            const dateKey = formatDate(currentDate);
            const classKey = currentClass;
            
            // Pastikan data sudah diinisialisasi
            initializeData();
            
            // Dapatkan data siswa untuk kelas yang dipilih
            const students = studentsByClass[classKey];
            
            // Filter siswa berdasarkan pencarian dan status
            const filteredStudents = students.filter(student => {
                const nameMatch = student.name.toLowerCase().includes(searchTerm);
                const statusMatch = filter === 'all' || attendanceData[dateKey][classKey][student.id] === filter;
                return nameMatch && statusMatch;
            });
            
            // Kosongkan tabel
            tableBody.innerHTML = '';
            
            // Hitung statistik
            let presentCount = 0;
            let permitCount = 0;
            let absentCount = 0;
            
            // Isi tabel dengan data siswa
            filteredStudents.forEach((student, index) => {
                const status = attendanceData[dateKey][classKey][student.id];
                
                // Hitung statistik
                if (status === 'present') presentCount++;
                else if (status === 'permit') permitCount++;
                else if (status === 'absent') absentCount++;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${student.name}</td>
                    <td>${student.class}</td>
                    <td>
                        <span class="status-badge ${status}">
                            ${status === 'present' ? 'Hadir' : status === 'permit' ? 'Izin' : 'Alfa'}
                        </span>
                    </td>
                    <td>
                        <div class="status-buttons">
                            <button class="status-btn present ${status === 'present' ? 'active' : ''}" data-id="${student.id}" data-status="present">Hadir</button>
                            <button class="status-btn permit ${status === 'permit' ? 'active' : ''}" data-id="${student.id}" data-status="permit">Izin</button>
                            <button class="status-btn absent ${status === 'absent' ? 'active' : ''}" data-id="${student.id}" data-status="absent">Alfa</button>
                        </div>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            // Perbarui statistik
            document.getElementById('presentCount').textContent = presentCount;
            document.getElementById('permitCount').textContent = permitCount;
            document.getElementById('absentCount').textContent = absentCount;
            
            // Tambahkan event listener untuk tombol status
            document.querySelectorAll('.status-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const studentId = parseInt(this.dataset.id);
                    const newStatus = this.dataset.status;
                    const dateKey = formatDate(currentDate);
                    const classKey = currentClass;
                    
                    // Perbarui status
                    attendanceData[dateKey][classKey][studentId] = newStatus;
                    
                    // Simpan ke localStorage
                    localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
                    
                    // Perbarui tampilan
                    updateDisplay();
                });
            });
        }

        // Fungsi untuk menampilkan tanggal saat ini
        function displayCurrentDate() {
            document.getElementById('currentDate').textContent = formatDateDisplay(currentDate);
            document.getElementById('datePicker').value = formatDate(currentDate);
        }

        // Fungsi untuk menampilkan modal folder data
        function showDataFolder() {
            const modal = document.getElementById('dataFolderModal');
            const modalBody = document.getElementById('modalBody');
            
            // Kosongkan modal body
            modalBody.innerHTML = '';
            
            // Ambil semua tanggal yang tersimpan
            const dates = Object.keys(attendanceData).sort().reverse();
            
            if (dates.length === 0) {
                modalBody.innerHTML = '<div class="empty-folder">Tidak ada data absensi yang tersimpan.</div>';
            } else {
                dates.forEach(date => {
                    const dateObj = new Date(date);
                    const formattedDate = formatDateShort(dateObj);
                    
                    const folder = document.createElement('div');
                    folder.className = 'data-folder';
                    
                    // Hitung statistik untuk tanggal ini
                    let totalStudents = 0;
                    let presentCount = 0;
                    let permitCount = 0;
                    let absentCount = 0;
                    
                    Object.keys(attendanceData[date]).forEach(classKey => {
                        const classData = attendanceData[date][classKey];
                        totalStudents += Object.keys(classData).length;
                        
                        Object.values(classData).forEach(status => {
                            if (status === 'present') presentCount++;
                            else if (status === 'permit') permitCount++;
                            else if (status === 'absent') absentCount++;
                        });
                    });
                    
                    folder.innerHTML = `
                        <div class="folder-header">
                            <div class="folder-title">${formattedDate}</div>
                            <div class="folder-actions">
                                <button class="folder-action-btn view" data-date="${date}">Lihat</button>
                                <button class="folder-action-btn delete" data-date="${date}">Hapus</button>
                            </div>
                        </div>
                        <div class="folder-content">
                            <div class="data-item">
                                <div class="data-info">
                                    <div class="data-date">${formattedDate}</div>
                                    <div class="data-stats">Total: ${totalStudents} siswa | Hadir: ${presentCount} | Izin: ${permitCount} | Alfa: ${absentCount}</div>
                                </div>
                                <div class="data-actions">
                                    <button class="data-action-btn view" data-date="${date}">Lihat</button>
                                    <button class="data-action-btn delete" data-date="${date}">Hapus</button>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    modalBody.appendChild(folder);
                });
            }
            
            // Tampilkan modal
            modal.style.display = 'flex';
            
            // Tambahkan event listener untuk tombol di modal
            document.querySelectorAll('.folder-action-btn.view, .data-action-btn.view').forEach(button => {
                button.addEventListener('click', function() {
                    const date = this.dataset.date;
                    currentDate = new Date(date);
                    displayCurrentDate();
                    updateDisplay();
                    closeModal();
                });
            });
            
            document.querySelectorAll('.folder-action-btn.delete, .data-action-btn.delete').forEach(button => {
                button.addEventListener('click', function() {
                    const date = this.dataset.date;
                    if (confirm(`Apakah Anda yakin ingin menghapus data absensi untuk tanggal ${formatDateShort(new Date(date))}?`)) {
                        delete attendanceData[date];
                        localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
                        showDataFolder(); // Perbarui tampilan folder
                        updateDisplay(); // Perbarui tampilan utama jika tanggal yang dihapus sedang dilihat
                    }
                });
            });
        }

        // Fungsi untuk menutup modal
        function closeModal() {
            const modal = document.getElementById('dataFolderModal');
            modal.style.display = 'none';
        }

        // Event listener untuk pemilih kelas
        document.querySelectorAll('.class-btn').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.class-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                this.classList.add('active');
                currentClass = this.dataset.class;
                updateDisplay();
            });
        });

        // Event listener untuk filter
        document.querySelectorAll('.filter-btn').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                this.classList.add('active');
                updateDisplay();
            });
        });

        // Event listener untuk pencarian
        document.getElementById('searchInput').addEventListener('input', updateDisplay);

        // Event listener untuk navigasi tanggal
        document.getElementById('prevDate').addEventListener('click', function() {
            currentDate.setDate(currentDate.getDate() - 1);
            displayCurrentDate();
            updateDisplay();
        });

        document.getElementById('nextDate').addEventListener('click', function() {
            currentDate.setDate(currentDate.getDate() + 1);
            displayCurrentDate();
            updateDisplay();
        });

        document.getElementById('datePicker').addEventListener('change', function() {
            currentDate = new Date(this.value);
            displayCurrentDate();
            updateDisplay();
        });

        // Event listener untuk tombol simpan
        document.getElementById('saveBtn').addEventListener('click', function() {
            localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
            alert('Data absensi berhasil disimpan!');
        });

        // Event listener untuk tombol reset
        document.getElementById('resetBtn').addEventListener('click', function() {
            if (confirm('Apakah Anda yakin ingin mereset data absensi hari ini?')) {
                const dateKey = formatDate(currentDate);
                const classKey = currentClass;
                
                studentsByClass[classKey].forEach(student => {
                    attendanceData[dateKey][classKey][student.id] = 'present'; // Reset ke hadir
                });
                
                localStorage.setItem('attendanceData', JSON.stringify(attendanceData));
                updateDisplay();
                alert('Data absensi hari ini telah direset!');
            }
        });

        // Event listener untuk tombol folder data
        document.getElementById('dataFolderBtn').addEventListener('click', showDataFolder);

        // Event listener untuk tombol tutup modal
        document.getElementById('closeModal').addEventListener('click', closeModal);

        // Tutup modal saat klik di luar konten modal
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('dataFolderModal');
            if (event.target === modal) {
                closeModal();
            }
        });

        // Inisialisasi tampilan
        displayCurrentDate();
        updateDisplay();